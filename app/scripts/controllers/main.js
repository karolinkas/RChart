'use strict';

angular.module('rgraphApp')
  .controller('MainCtrl', function ($scope,loadData,$filter) {
  	/* jshint unused:false */	

    $scope.url = '/files/Sample_data.json';

    loadData($scope.url)
      .success(function(data){
        var valueArray = [];
        var timeArray = [];

        function arrange(element,i,array){
          var day = new Date(element.time);
          var niceDate = $filter('date')(day,'MMM,dd');
          valueArray.push(element.value);
          timeArray.push(niceDate);
        }

        for(var key in data){
          var datainner = data[key];
          for(var keyinner in datainner){
            var array = datainner[keyinner];
            array.forEach(arrange);
          }
        }

        $scope.data = {
          time: timeArray,
          value: valueArray
        };
        console.log(data);
        // $scope.less = function(){
        //   console.log('jaja');
        //   $scope.data.value.splice(0,10);
        //   return $scope.data;
        // }; 
      
      });

  });


  // {
  //   "Deposit 5k.Block 132": {
  //     "Power Cost": [
  //       {
  //         "time": "2015-02-01T00:00:00.000Z",
  //         "value": 0
  //       },
  //       {
  //         "time": "2015-02-02T00:00:00.000Z",
  //         "value": 0
  //       },
  //       {
  //         "time": "2015-02-03T00:00:00.000Z",
  //         "value": 0
  //       },
  //       {
  //         "time": "2015-02-04T00:00:00.000Z",
  //         "value": 0
  //       },
  //       {
  //         "time": "2015-02-05T00:00:00.000Z",
  //         "value": 0
  //       },
  //       {
  //         "time": "2015-02-06T00:00:00.000Z",
  //         "value": 14.74306836917094
  //       },
  //       {
  //         "time": "2015-02-07T00:00:00.000Z",
  //         "value": 14.356954385523148
  //       },
  //       {
  //         "time": "2015-02-08T00:00:00.000Z",
  //         "value": 14.742364982164354
  //       },
  //       {
  //         "time": "2015-02-09T00:00:00.000Z",
  //         "value": 15.41415753429861
  //       },
  //       {
  //         "time": "2015-02-10T00:00:00.000Z",
  //         "value": 15.298038758087964
  //       },
  //       {
  //         "time": "2015-02-11T00:00:00.000Z",
  //         "value": 14.887825277259262
  //       },
  //       {
  //         "time": "2015-02-12T00:00:00.000Z",
  //         "value": 15.581907114496527
  //       },
  //       {
  //         "time": "2015-02-13T00:00:00.000Z",
  //         "value": 13.80928745530093
  //       },
  //       {
  //         "time": "2015-02-14T00:00:00.000Z",
  //         "value": 13.75291289654514
  //       },
  //       {
  //         "time": "2015-02-15T00:00:00.000Z",
  //         "value": 16.11809009968866
  //       },
  //       {
  //         "time": "2015-02-16T00:00:00.000Z",
  //         "value": 13.755144306746528
  //       },
  //       {
  //         "time": "2015-02-17T00:00:00.000Z",
  //         "value": 11.705747502322922
  //       },
  //       {
  //         "time": "2015-02-18T00:00:00.000Z",
  //         "value": 12.330925670520832
  //       },
  //       {
  //         "time": "2015-02-19T00:00:00.000Z",
  //         "value": 12.273661558431712
  //       },
  //       {
  //         "time": "2015-02-20T00:00:00.000Z",
  //         "value": 12.205849379429399
  //       },
  //       {
  //         "time": "2015-02-21T00:00:00.000Z",
  //         "value": 12.127179151322917
  //       },
  //       {
  //         "time": "2015-02-22T00:00:00.000Z",
  //         "value": 12.004797888323498
  //       },
  //       {
  //         "time": "2015-02-23T00:00:00.000Z",
  //         "value": 11.93507459815625
  //       },
  //       {
  //         "time": "2015-02-24T00:00:00.000Z",
  //         "value": 11.894609643679397
  //       },
  //       {
  //         "time": "2015-02-25T00:00:00.000Z",
  //         "value": 11.83725793753588
  //       },
  //       {
  //         "time": "2015-02-26T00:00:00.000Z",
  //         "value": 11.88089898125463
  //       },
  //       {
  //         "time": "2015-02-27T00:00:00.000Z",
  //         "value": 11.878591662452544
  //       },
  //       {
  //         "time": "2015-02-28T00:00:00.000Z",
  //         "value": 11.342605069484955
  //       },
  //       {
  //         "time": "2015-03-01T00:00:00.000Z",
  //         "value": 11.387495969111692
  //       },
  //       {
  //         "time": "2015-03-02T00:00:00.000Z",
  //         "value": 12.249498353736689
  //       },
  //       {
  //         "time": "2015-03-03T00:00:00.000Z",
  //         "value": 12.235311920133105
  //       },
  //       {
  //         "time": "2015-03-04T00:00:00.000Z",
  //         "value": 12.187197744763893
  //       },
  //       {
  //         "time": "2015-03-05T00:00:00.000Z",
  //         "value": 12.000412882892363
  //       },
  //       {
  //         "time": "2015-03-06T00:00:00.000Z",
  //         "value": 11.64977788376389
  //       },
  //       {
  //         "time": "2015-03-07T00:00:00.000Z",
  //         "value": 11.59678079223611
  //       }
  //     ]
  //   }
  // }